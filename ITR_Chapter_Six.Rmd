---
title: "Intro to R - Control Flow and Functions"
output:
  html_document: 
    theme: united
    highlight: tango
    toc: yes
    toc_float: yes
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, echo=FALSE}
htmltools::img(src = knitr::image_uri("./Images/LATree.PNG"),
               alt = "logo", 
               style = "position:absolute; top:0; right:0; padding:10px; width:200px;")
```


***

# Learning Objectives

**The goal of this chapter is to:**

* Be able to use conditional statements: *if*, *else* and *else if*.

* Be able to use loops: *for* loops and *while* loops

* Learn what functions are.

* Understand why we need to use functions.

* Be able to write functions.

* Have a basic understanding of scoping within functions.


***

# Loops

Loops are a fundamental concept in traditional programming languages. 

>A loop is a way to repeat a number commands until a given condition is met.

Since R is a vectorised language, loops are not as prominently used in R as in Python for example. Despite this, they are key to programming in general and can save you lot's of time and typing in certain cases.


They allow you to automate parts of your code that are in need of repetition.

Similar to how functions help make our code more abstract and general, loops are similar. As we are essentially simplifying a specific case to a more general case.

We are going to look at two types of loops.

* for loops

* while loops

## For Loops

These are the most common types.

They follow the basic structure below,


```{r, eval=FALSE}

Basic Structure of a loop

#create an empty output
#which we will fill when the loop runs

output <- c()

#creating the loop

for (Variable in Vector) { 
  
  output <- commands
  
}

```


* So we start with creating an empty vector for our output

>>Before you start the loop, you should allocate sufficient space for the output.

* And then start with the word `for`

* followed by `()` brackets where we specify an index variable, `i` is commonly used but it can be anything that you want.

* then the word `in`

* then specify an interable. In this case it is `Vector`.

* followed by the `{}` curly brackets, which will have our commands, these could be multiple lines of code.

***

>An iterable is an object that can be iterated through, one element at a time. Lists and vectors are both iterables.

***

lets look at an example.


We start by creating an interable, I have created a vector with **numbers between 0 and 5**.


```{r}
#Creating a vector

example_vector <- c(0,1,2,3,4,5)

```

Creating our loop.

```{r}
#create an empty output
#which we will fill when the loop runs

result <- c()

#creating the loop

for (each_number in example_vector) { 
  
  result <- base::append(result, each_number * 2)
  
}

#To display the data
result


```

This loop is taking each number in our example vector and multiplying it by 2.

The keyword `for` is followed by a variable that refers to each item in my iterable. I’ve called this variable each_number . You’ll often see letters like i used here.

The keyword in is followed by the iterable I want to loop over (here it is example vector)

My Command are assigned to `result`.The command here is to multiply each number in example vector by 2


>append() function simply adds elements to a vector.

>Loops suppress output, unless explicitly `print()`ed out.

We can also use functions within our For loops – here we’re using the length() function to return the length of each day of the week.

```{r,eval=FALSE}
days_vector <- c("Monday", "Tuesday", "Wednesday", "Thursday",
             "Friday", "Saturday", "Sunday")


#create an empty output
#which we will fill when the loop runs

result <- c()

#creating the loop

for (day in days_vector) { 
  
  print(day, "has a lenght of", length(day))
  
  result <- base::append(result, each_number * 2)
  
}

#To display the data
result




```


***

## While loops

Our other type of loops are while loops.

For loops iterate a set amount of times, or over a set number of things. A while loop iterates until it no longer meets a certain condition.


```{r, eval=FALSE}

#create an empty output
#which we will fill when the loop runs

result <- c()


#creating the loop


while (logical condition) { 
  
  result <- commands
  
}

#To display the data
result

```

* So we start with creating an empty vector for our output

* Then the word `while`
 
* followed by the `()` brackets in which we specify our logical condition, using the **conditional operators**.

* and then `{}`, which surrounds our commands. These commands will be run repeatedly in order as long as the specified condtion is `TRUE`.

lets look at an example:

- If we say `stop value` is assigned to 0.

- and we set out condtion to be `stop value < 5`

- then print `stop value`

- and then `add a 1`

```{r}

#create an empty output
#which we will fill when the loop runs

result <- c()


#Setting the value
stop_value <- 0


#Creating the loop
#Our condition here is that 0<5 i.e stop_value

while (stop_value < 5) { 
  
  print(stop_value)
  
  stop_value <- stop_value +1 
  
  result <- base::append(result, stop_value+1)
}

#To display the data
result
```

Can you guess what would happen if we removed the   `stop_value <- stop_value +1` ?

```{r,eval=FALSE}
#create an empty output
#which we will fill when the loop runs
result <- c()


#Setting the value
stop_value <- 0


#Creating the loop
#Our condition here is that 0<5 i.e stop_value

while (stop_value < 5) { 
  
  print(stop_value)
  
  result <- base::append(result, stop_value+1)
}

#To display the data
result

```

If we removed the code `stop_value <- stop_value +1` , `0` would always be less than `5` and the loop would be stuck in an infinite loop, as R will keep running the code. 

>You will have to hit the stop sign to exit the loop.

## Exercise loops{.tabset .tabset-fade}

>While Loop Exercise

### **Exercise**{-}

1. Code a `while` loop with the following characteristics:

- Assign the value of a variable `temperature` to be 40.

- The condition of the `while` loop, should check if the temperature is higher than `20`

- The first command in the body should print out `"Its way too hot!"`

- The next command should decrease the `temperature` by `2` and assign this new value to `temperature` again.

### **Hint**{-}

1. Code a `while` loop with the following characteristics:

- Assign the value of a variable `temperature` to be 40.

- The condition of the `while` loop, should check if the temperature is higher than `20`

- The first command in the body should print out `"Its way too hot!"`

- The next command should decrease the `temperature` by `2` and assign this new value to `temperature` again.

```{r, eval=FALSE}
#create an empty output
#which we will fill when the loop runs

result <- c()

#setting the temperature value

temperature <- 40

# Code the while loop
while (condition) {
  
  conditions
  
  result <- base::append(result, temperature)
  
}

#To display the data
result

```


### **Show Answer**{-}

1. Code a `while` loop with the following characteristics:

- Assign the value of a variable `temperature` to be 40.

- The condition of the `while` loop, should check if the temperature is higher than `20`

- The first command in the body should print out `"Its way too hot!"`

- The next command should decrease the `temperature` by `2` and assign this new value to `temperature` again.

```{r}
#create an empty output
#which we will fill when the loop runs

result <- c()

#setting the temperature value

temperature <- 40

# Code the while loop
while (temperature > 20) {
  
  print("It way too hot!")
  
  temperature <- temperature - 2
  
  result <- base::append(result, temperature)
  
}

#To display the data
result

```


